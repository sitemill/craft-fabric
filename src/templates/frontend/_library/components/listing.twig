{% set entriesSections = craft.library.settings.entriesSections|default(null) %}

{% if librarySettings.assetsSource %}
    {% if librarySettings.assetsSource == 'dam' %}
        {% set assets = craft.damAssets %}
    {% else %}
        {% set assets = craft.assets.folderId(librarySettings.assetsSource) %}
    {% endif %}

    {% set assetsQuery = assets
        .search(keywords)
        .kind(kind)
        .relatedTo(category)
        .orderBy(order)
        .with(['file[0]'])
        .limit(30)
    %}

    {% include '_library/components/listing/assets.twig' %}
{% endif %}

{% if entriesSections %}
    {% set entries = craft.entries.section(entriesSections) %}

    {% set entriesQuery = entries
        .search(keywords)
        .relatedTo(category)
        .orderBy(order)
        .limit(30) %}

    {% include '_library/components/listing/entries.twig' %}
{% endif %}