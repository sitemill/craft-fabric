{#
/**
 * Library plugin for Craft CMS 3.x
 *
 * Library Settings.twig
 *
 * @author    SiteMill
 * @copyright Copyright (c) 2020 SiteMill
 * @link      https://sitemill.co
 * @package   Library
 * @since     1.0.0
 */
#}

{% import "_includes/forms" as forms %}


{{ forms.lightswitchField({
    label: 'Public Site',
    instructions: 'If enabled, the site will be accessible by everyone',
    id: 'public',
    name: 'public',
    value: settings.public,
    on: (settings.public is defined) ? settings.public : ""})
}}



{% set sources = {
        'disabled' : {
            label: 'Disabled',
            value: '0'
        },
    }
%}

{% set plugin = craft.app.plugins.getPlugin('dam', false) %}

{% if plugin is not null and plugin.isInstalled  %}
    {% set sources = sources|merge({
        'dam' : {
            label: 'Digital Asset Manager',
            value: 'dam'
        }
    }) %}
{% endif %}

{% for volume in craft.app.volumes.allVolumes %}
    {% set folder = craft.app.assets.rootFolderByVolumeId(volume.id) %}
    {% set sources = sources|merge({
        (volume.handle) : {
            label: volume.name,
            value: folder.id
        }
    }) %}
{% endfor %}

    {{ forms.selectField({
        label: 'Assets source',
        instructions: 'Select the asset source to use'|t('dam'),
        id: 'assetsSource',
        name: 'assetsSource',
        value: settings.assetsSource,
        options: sources
        })
    }}



